<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.1.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Kim Carter" />

  
  
  
    
  
  <meta name="description" content="In this post Kim discusses: His learnings while implementing the Tls Tester. The architectural discoveries and changes that had to be made as part of releasing the Tls Tester. What you can expect from the new Tester." />

  
  <link rel="alternate" hreflang="en-us" href="https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/" />

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#2962ff" />
  

  
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">

    
    

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/monokai-sublime.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/monokai-sublime.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.61a09214626b6562393273f533fbd812.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=G-6MDLFKRDK7"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-6MDLFKRDK7', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MSX3HL3');
</script>


  

  




  
  
  

  

  
    <link rel="manifest" href="/index.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hucbeaefadcabadfc36a04f355e211002f_10166_32x32_fill_lanczos_center_2.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hucbeaefadcabadfc36a04f355e211002f_10166_180x180_fill_lanczos_center_2.png" />

  <link rel="canonical" href="https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/" />

  
  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@binarymist" />
    <meta property="twitter:creator" content="@binarymist" />
  
  <meta property="og:site_name" content="BinaryMist" />
  <meta property="og:url" content="https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/" />
  <meta property="og:title" content="PurpleTeam TLS Tester Implementation | BinaryMist" />
  <meta property="og:description" content="In this post Kim discusses: His learnings while implementing the Tls Tester. The architectural discoveries and changes that had to be made as part of releasing the Tls Tester. What you can expect from the new Tester." /><meta property="og:image" content="https://binarymist.io/media/sharing.png" />
    <meta property="twitter:image" content="https://binarymist.io/media/sharing.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2021-09-07T17:17:11&#43;13:00"
      />
    
    <meta property="article:modified_time" content="2021-09-07T17:17:11&#43;13:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/"
  },
  "headline": "PurpleTeam TLS Tester Implementation",
  
  "datePublished": "2021-09-07T17:17:11+13:00",
  "dateModified": "2021-09-07T17:17:11+13:00",
  
  "author": {
    "@type": "Person",
    "name": "Kim Carter"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "BinaryMist Ltd",
    "logo": {
      "@type": "ImageObject",
      "url": "https://binarymist.io/media/logo_hu7f475199c23c94d50b94359f71ddf7c9_5675_192x192_fit_lanczos_2.png"
    }
  },
  "description": "In this post Kim discusses: His learnings while implementing the Tls Tester. The architectural discoveries and changes that had to be made as part of releasing the Tls Tester. What you can expect from the new Tester."
}
</script>

  

  

  

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=eE5zemPbe7">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=eE5zemPbe7">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=eE5zemPbe7">
<link rel="manifest" href="/manifest.json?v=eE5zemPbe7">
<link rel="mask-icon" href="/safari-pinned-tab.svg?v=eE5zemPbe7" color="#5bbad5">
<link rel="shortcut icon" href="/favicon.ico?v=eE5zemPbe7">
<meta name="theme-color" content="#ffffff">


  <title>PurpleTeam TLS Tester Implementation | BinaryMist</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="80350d52abb1a8dce530b0a95061dece" >

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.226a9011996d125bf3fe4a5f22353a49.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    











  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu7f475199c23c94d50b94359f71ddf7c9_5675_0x70_resize_lanczos_2.png" alt="BinaryMist"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/media/logo_hu7f475199c23c94d50b94359f71ddf7c9_5675_0x70_resize_lanczos_2.png" alt="BinaryMist"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#services"><span>Services</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#portfolio"><span>Portfolio</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks-workshops"><span>Talks/Workshops</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  









<div class="article-header">
  
  
    <img src="/media/headers/PurpleTeam_landscape_rev.svg" class="article-banner" alt="PurpleTeam">
  

  <span class="article-header-caption">PurpleTeam</span>
</div>




  

  
  
  
<div class="article-container pt-3">
  <h1>PurpleTeam TLS Tester Implementation</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span >
      <a href="/author/kim-carter/">Kim Carter</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Sep 7, 2021
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  
  
  
    
    
    
            
       
                
      
      
    
  

  
  

</div>

    




<div class="btn-links mb-3">
  
  








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://purpleteam-labs.com" target="_blank" rel="noopener">
    <i class="fas fa-project-diagram mr-1"></i>
    Project
  </a>

  
  
  
    
  
  
  
  
  
    
    
      
    
  
  <a class="btn btn-outline-primary btn-page-header" href="/event/2021-purple-teaming-with-purpleteam-owasp-20th-anniversary/" >
    <i class="fas fa-microphone-alt mr-1"></i>
    Talk
  </a>

  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://purpleteam-labs.com/project/video-pt-full-system-run-2021/" target="_blank" rel="noopener">
    <i class="fas fa-video mr-1"></i>
    Video
  </a>

  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://binarymist.io/publication/ser-podcast-owasp-purpleteam/" target="_blank" rel="noopener">
    <i class="fas fa-podcast mr-1"></i>
    Interview
  </a>

  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://twitter.com/purpleteamlabs" target="_blank" rel="noopener">
    <i class="fab fa-twitter mr-1"></i>
    Follow
  </a>


</div>


  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>The <em>PurpleTeam</em> TLS <em>Tester</em> is now implemented. I&rsquo;ve written this post to highlight the learnings, and to talk about the various significant changes that were made as part of the release. All core components were released as version <code>1.0.0-alpha.3</code>.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/nJNAbGLCGNY" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<br>
<p>The details of the above video can be found <a href="https://purpleteam-labs.com/project/video-pt-full-system-run-2021/" target="_blank" rel="noopener">here</a>.</p>
<h1 id="contents">Contents</h1>
<ul>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#work-items-created">Work items created</a></li>
<li><a href="#synchronisation">Synchronisation</a>
<ul>
<li><a href="#time-outs">Time-outs</a>
<ul>
<li><a href="#cli">CLI</a>
<ul>
<li><a href="#for-the-test-command">For the <code>test</code> command</a></li>
<li><a href="#for-tester-progress--pctcomplete--bugcount--updates">For <code>tester</code>[ <code>Progress</code> | <code>PctComplete</code> | <code>BugCount</code> ] updates</a></li>
</ul>
</li>
<li><a href="#orchestrator">Orchestrator</a></li>
<li><a href="#app-tester">App Tester</a></li>
<li><a href="#tls-tester">Tls Tester</a></li>
</ul>
</li>
<li><a href="#message-flows">Message flows</a></li>
</ul>
</li>
<li><a href="#tls-tester-implementation">TLS Tester Implementation</a></li>
</ul>
<p>All of the release notes can be accessed from the <em>PurpleTeam</em> <a href="https://purpleteam-labs.com/doc/changelog/" target="_blank" rel="noopener">Changelog</a> page and/or the <a href="https://github.com/purpleteam-labs/purpleteam/issues/60" target="_blank" rel="noopener">Github issue</a>.</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Massive set of releases just gone live around the new <a href="https://twitter.com/hashtag/SSL?src=hash&amp;ref_src=twsrc%5Etfw">#SSL</a> <a href="https://twitter.com/hashtag/TLS?src=hash&amp;ref_src=twsrc%5Etfw">#TLS</a> <a href="https://twitter.com/hashtag/Tester?src=hash&amp;ref_src=twsrc%5Etfw">#Tester</a> <a href="https://t.co/f0bPNRBjUh">https://t.co/f0bPNRBjUh</a></p>&mdash; PurpleTeam (@purpleteamlabs) <a href="https://twitter.com/purpleteamlabs/status/1433018222412910595?ref_src=twsrc%5Etfw">September 1, 2021</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h1 id="documentation">Documentation</h1>
<ul>
<li>The <a href="https://purpleteam-labs.com/doc/definitions/" target="_blank" rel="noopener">Definitions</a> were updated</li>
<li>The <a href="https://purpleteam-labs.com/doc/log-and-outcomes-files/" target="_blank" rel="noopener">Log and Outcomes files</a> page was created, providing details of the <em>Outcomes</em> archive, what&rsquo;s in it and how to read specific files. You can also <a href="https://www.youtube.com/watch?v=nJNAbGLCGNY&amp;t=346s" target="_blank" rel="noopener">see the contents</a> of the <em>Outcomes</em> archive for <a href="https://github.com/purpleteam-labs/purpleteam/blob/main/testResources/jobs/job_1.0.0-alpha.3_local" target="_blank" rel="noopener">this <em>Job</em> file</a></li>
<li>The main architecture diagrams for <a href="https://purpleteam-labs.com/doc/cloud/" target="_blank" rel="noopener"><code>cloud</code></a> and <a href="https://purpleteam-labs.com/doc/local/set-up/" target="_blank" rel="noopener"><code>local</code></a> have been updated</li>
<li>The <em>Job</em> file schema has been <a href="https://purpleteam-labs.com/doc/job-file/" target="_blank" rel="noopener">documented</a></li>
<li>A <a href="https://purpleteam-labs.com/doc/faq/" target="_blank" rel="noopener">FAQ</a> page was created</li>
<li><a href="https://purpleteam-labs.com/doc/local/set-up/#tls-scanner" target="_blank" rel="noopener">Setting up</a> the Tls Tester, although this is trivial</li>
<li><a href="https://purpleteam-labs.com/doc/local/workflow/#other-testers" target="_blank" rel="noopener">Debugging the Tls Tester</a></li>
</ul>
<h1 id="work-items-created">Work items created</h1>
<p>As a result of the Tls Tester Implementation</p>
<ul>
<li><a href="https://github.com/purpleteam-labs/purpleteam/issues/87" target="_blank" rel="noopener">Re-work orchestrator.js</a></li>
<li><a href="https://github.com/purpleteam-labs/purpleteam/issues/88" target="_blank" rel="noopener">Create Tester reset for &ldquo;Tester failure:&rdquo; occurrances</a></li>
<li><a href="https://github.com/purpleteam-labs/purpleteam/issues/89" target="_blank" rel="noopener">Improve orchestrator Tester model error handling</a></li>
<li><a href="https://github.com/purpleteam-labs/purpleteam/issues/90" target="_blank" rel="noopener">Re-work App and Tls Tester models</a></li>
<li><a href="https://github.com/purpleteam-labs/purpleteam/issues/91" target="_blank" rel="noopener">Re-work Dockerfiles</a></li>
<li><a href="https://github.com/purpleteam-labs/purpleteam/issues/92" target="_blank" rel="noopener">Extract common code into package</a></li>
<li><a href="https://github.com/purpleteam-labs/purpleteam/issues/93" target="_blank" rel="noopener">Blog post on the TLS Scanner</a></li>
</ul>
<h1 id="synchronisation">Synchronisation</h1>
<p>There ended up being quite a bit of work done around synchronisation of the components, and there is still work to be done. There were architectural decisions made several years ago that needed some modification, and as you can see from the <a href="#work-items-created">Work items created</a> there is ongoing work that needs to be done.</p>
<p>For example I discovered near the end of the implementation another edge-case around state of a given <em>Tester</em> being incorrect if a different <em>Tester</em> is in a <code>Tester failure:</code> state.
You can read about the issue <a href="https://github.com/purpleteam-labs/purpleteam/issues/88" target="_blank" rel="noopener">here</a>. We will be addressing this one soon.</p>
<p>Then there is this <a href="https://github.com/purpleteam-labs/purpleteam/issues/89" target="_blank" rel="noopener">lack of retry issue</a> in the <em>orchestrator</em> <em>Tester</em> models which was found near the end of the TLS implementation work also, which probably won&rsquo;t occur very often at all (we have never witnessed it), but it still needs to be fixed.</p>
<mark>Before we get started discussing the synchronisation of components, you will need some understanding of the various relevant time-outs in the code base.</mark>
<h2 id="time-outs">Time-outs</h2>
<p>Many of the time-out issues with AWS just don&rsquo;t exist when running <code>local</code>ly. AWS Api Gateway does not support streaming, so we need to use long polling (<code>lp</code>) between the CLI and the <em>orchestrator</em> in the <code>cloud</code> environment.</p>
<h3 id="cli">CLI</h3>
<h4 id="for-the-test-command">For the <code>test</code> command</h4>
<p>The initial request to the <em>orchestrator</em> for the <code>test</code> command has a set of timeouts, but it must stop trying before the back-end fails due to:</p>
<ul>
<li>Stage Two containers not being up and responsive within the currently <code>120000</code> (<code>s2containers.serviceDiscoveryServiceInstances.timeoutToBeAvailable</code>) + <code>30000</code> (<code>s2containers.responsive.timeout</code>) duration</li>
<li>The Stage Two container service discovery services not being up and responsive within the same duration as above</li>
</ul>
<div id="cli_continues_to_retry"></div>
<p>If the CLI continues to retry after a back-end timeout, then it may continue to do so indefinitely if unsupervised, as is likely if being used in <a href="https://github.com/purpleteam-labs/purpleteam#ui" target="_blank" rel="noopener"><code>noUi</code> mode</a>.</p>
<p>The <a href="https://github.com/purpleteam-labs/purpleteam/blob/0a054e46d02bfbd561f8b2797e86a9d16df484d3/src/presenter/apiDecoratingAdapter.js#L215" target="_blank" rel="noopener">time-out series</a> for the <code>test</code> command currently looks like the following for the <code>cloud</code> environment. The CLI doesn&rsquo;t timeout at all for <code>local</code>:</p>
<p>Tries:</p>
<ol>
<li>23000,</li>
<li>15000,</li>
<li>15000,</li>
<li>10010,</li>
<li>10010,</li>
<li>10010,</li>
<li>10010,</li>
<li>10010,</li>
<li>10010,</li>
<li>10010,</li>
<li>10010,</li>
<li>10010,</li>
<li>0 // Cancel</li>
</ol>
<p>This adds up to 143090 + some request and response latency, a little short of 150000 + some comms latency in the AWS machine.</p>
<h4 id="for-tester-progress--pctcomplete--bugcount--updates">For <code>tester</code>[ <code>Progress</code> | <code>PctComplete</code> | <code>BugCount</code> ] updates</h4>
<p>Five long-poll request attempts with no data returned from the <em>orchestrator</em> and the CLI gives up.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ...,
</span><span style="color:#75715e"></span><span style="color:#a6e22e">testerFeedbackComms</span><span style="color:#f92672">:</span> {
  <span style="color:#a6e22e">longPoll</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">nullProgressMaxRetries</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The number of times (sequentially receiving an event with a data object containing a property with a null value) to poll the backend when the orchestrator is not receiving feedback from the testers.&#39;</span>,
      <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;int&#39;</span>,
      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">5</span>
    }
  }
},
<span style="color:#75715e">// ...
</span></code></pre></div>
<h3 id="orchestrator">Orchestrator</h3>
<p>The following is used in the <code>testerWatcher</code> and needs to be well under the AWS API Gateway timeout which is 30 seconds:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ...,
</span><span style="color:#75715e"></span><span style="color:#a6e22e">testerFeedbackComms</span><span style="color:#f92672">:</span> {
  <span style="color:#75715e">// ...,
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">longPoll</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">timeout</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;A double that expresses seconds to wait for blocking Redis commands. We need to timeout well before the AWS Api Gateway timeout.&#39;</span>,
      <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> Number,
      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">20.0</span>
    }
  }
}
</code></pre></div>
<h3 id="app-tester">App Tester</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ...,
</span><span style="color:#75715e"></span><span style="color:#a6e22e">s2Containers</span><span style="color:#f92672">:</span> {
  <span style="color:#a6e22e">serviceDiscoveryServiceInstances</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">timeoutToBeAvailable</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The duration in milliseconds before giving up on waiting for the s2 Service Discovery Service Instances to be available.&#39;</span>,
      <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;duration&#39;</span>,
<span style="display:block;width:100%;background-color:#3c3d38">      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">120000</span>
</span>    },
    <span style="color:#a6e22e">retryIntervalToBeAvailable</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The retry interval in milliseconds for the s2 Service Discovery Service Instances to be available.&#39;</span>,
      <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;duration&#39;</span>,
      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">5000</span>
    }
  },
  <span style="color:#a6e22e">responsive</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">timeout</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The duration in milliseconds before giving up on waiting for the s2 containers to be responsive.&#39;</span>,
      <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;duration&#39;</span>,
<span style="display:block;width:100%;background-color:#3c3d38">      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30000</span>
</span>    },
    <span style="color:#a6e22e">retryInterval</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The retry interval in milliseconds for the s2 containers to be responsive.&#39;</span>,
      <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;duration&#39;</span>,
      <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2000</span>
    }
  }
},
<span style="color:#75715e">// ...
</span></code></pre></div>
<p>The <code>emissary.apiFeedbackSpeed</code> is used to send the CLI the following message types: <code>testerProgress</code>, <code>testerPctComplete</code> and <code>testerBugCount</code>, thus keeping the <code>lp</code> alive. This duration needs to be less than the <em>orchestrator&rsquo;s</em> <code>20</code> second <code>testerFeedbackComms.longPoll.timeout</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">emissary</span><span style="color:#f92672">:</span> {
  <span style="color:#75715e">// ...,
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">apiFeedbackSpeed</span><span style="color:#f92672">:</span> {
    <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The speed to poll the Zap API for feedback of test progress&#39;</span>,
    <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;duration&#39;</span>,
    <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">5000</span>
  },
  <span style="color:#75715e">// ...
</span></code></pre></div>
<h3 id="tls-tester">TLS Tester</h3>
<p>If we don&rsquo;t receive any update from the TLS <em>Emissary</em> within this duration (<code>messageChannelHeartBeatInterval</code>) then the TLS <em>Tester</em> sends the CLI a <code>testerProgress</code> message with the <code>textData</code>: <code>Tester is awaiting Emissary feedback...</code>. This duration needs to be less than the <em>orchestrator&rsquo;s</em> <code>20</code> second <code>testerFeedbackComms.longPoll.timeout</code> to make sure the CLI continues to poll the <em>orchestrator</em> for <code>tester[Progress|PctComplete|BugCount]</code> updates.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#75715e">// ...,
</span><span style="color:#75715e"></span><span style="color:#a6e22e">messageChannelHeartBeatInterval</span><span style="color:#f92672">:</span> {
  <span style="color:#a6e22e">doc</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;This is used to send heart beat messages every n milliseconds. Primarily to keep the orchestrator\&#39;s testerWatcher longPoll timeout from being reached.&#39;</span>,
  <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;duration&#39;</span>,
  <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">15000</span>
},
<span style="color:#75715e">// ...
</span></code></pre></div>
<h2 id="message-flows">Message flows</h2>
<p>There are two flow types in play between the <em>orchestrator</em> and the CLI, namely Server Sent Events (<code>sse</code>) and Long Polling (<code>lp</code>).</p>
<p><mark>Before reading this section dive over to the <em>orchestrator</em> <a href="https://github.com/purpleteam-labs/purpleteam-orchestrator/blob/main/README.md#configuration" target="_blank">README</a> for a quick run-down on how <em>PurpleTeam</em> is using <code>sse</code> and <code>lp</code>.</mark> </p>
<p>Before The TLS implementation, the <code>testerFeedbackComms.medium</code> was defined in the configuration for both the <em>orchestrator</em> and the CLI. Both configurations had to match. If they didn&rsquo;t the <em>orchestrator</em> would respond with an error message. Now this is defined in the <em>orchestrator</em> only and the <em>orchestrator</em> tells the CLI which medium it should use before stating either <code>sse</code> or <code>lp</code>.</p>
<br>
<p>When the CLI runs the <code>test</code> command, there are three significant sequential events, I&rsquo;ll brush over or omit less significant events to make explaining the flow easier to understand. If you&rsquo;d rather just read the code it&rsquo;s <a href="https://github.com/purpleteam-labs/purpleteam-orchestrator/blob/15804fe13a294d7b37b5f2758833f562298f5685/src/api/orchestration/models/orchestrate.js#L177" target="_blank" rel="noopener">here</a>:</p>
<ol>
<li><strong>CLI makes a <code>POST</code> request</strong> to the <em>orchestrator&rsquo;s</em> <code>/test</code> route with the <em>Job</em>, and continues to do so according to it&rsquo;s <a href="#cli_continues_to_retry">retry schedule</a>.<br>
The <em>orchestrator&rsquo;s</em> <code>testTeamAttack</code> routine is where a lot of the decision making occurs
<ul>
<li>If a <em>Test Run</em> is already in progress (<code>initTesterResponsesForCli</code> is defined) and the <em>orchestrator</em> already has the responses from the requests to the <em>Testers</em> <code>/init-tester</code> route (<code>initTesterResponsesForCli</code> has a length), whether the <em>Testers</em> were successfully initialised or not, then the <em>Tester</em> responses along with whether to use <code>sse</code> or <code>lp</code> to subscribe to <em>Tester</em> feedback are returned to the CLI</li>
<li>If a <em>Test Run</em> is already in progress (<code>initTesterResponsesForCli</code> is defined), the <em>orchestrator</em> causes a client-side time-out because a response from the request to the <em>Testers</em> <code>/init-tester</code> route has not yet been received, and the <em>orchestrator</em> wants the CLI to try again once it times out</li>
<li>If execution gets past the above then a <em>Test Run</em> is not currently in progress, so the <em>orchestrator</em>:
<ol>
<li>Sets a in-progress flag</li>
<li>Asks it&rsquo;s <em>Tester</em> models to initialise their <em>Testers</em> and wait for the responses</li>
<li>Once all of the responses are received, the <em>orchestrator</em> populates a <code>failedTesterInitialisations</code> array with any <code>Tester failure:</code>&hellip; messages</li>
<li>The <em>orchestrator</em> creates a <code>startTesters</code> boolean and assigns it true if every active <em>Tester</em> has it&rsquo;s state set to <code>Tester initialised.</code>&hellip; (not <code>Awaiting Job.</code>, <code>Initialising Tester.</code>, or <code>[App|Tls] tests are running.</code>), otherwise false is assigned</li>
<li>If there were any <code>failedTesterInitialisations</code> or <code>startTesters</code> is false:
<ol>
<li><code>initTesterResponsesForCli</code> is populated with the responses from trying to initialise the <em>Testers</em> (both successful and/or unsuccessful)</li>
<li>A response is returned to the CLI with <code>initTesterResponsesForCli</code> and whether the <em>orchestrator</em> expects the CLI to use <code>sse</code> or <code>lp</code></li>
</ol>
</li>
<li>Otherwise:
<ol>
<li>
<p>The <em>orchestrator</em> invokes each <em>Testers</em> <code>/start-tester</code> route</p>
</li>
<li>
<p>If we are running in <code>cloud</code> the <em>orchestrator</em> warms up the <em>Test Session</em> message (Redis) channels and lists, this waits for all <em>Testers</em> of the represented <em>Test Sessions</em> to provide their first message set. These message sets are assigned to an array called <code>warmUpTestSessionMessageSets</code> which looks like the following before being populated with messages:<br>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">[
  {
    <span style="color:#a6e22e">channelName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;app-lowPrivUser&#39;</span>,
    <span style="color:#a6e22e">testerMessageSet</span><span style="color:#f92672">:</span> []
  }, {
    <span style="color:#a6e22e">channelName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;app-adminUser&#39;</span>,
    <span style="color:#a6e22e">testerMessageSet</span><span style="color:#f92672">:</span> []
  }, {
    <span style="color:#a6e22e">channelName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;tls-NA&#39;</span>,
    <span style="color:#a6e22e">testerMessageSet</span><span style="color:#f92672">:</span> []
  }
]
</code></pre></div></p>
<p>If <em>Testers</em> are started and the <em>orchestrator</em> did not subscribe to the <em>Test Session</em> message channels, it would never know when the <em>Test Sessions</em> are finished in order to clean-up, so this subscription must occur</p>
</li>
<li>
<p><code>initTesterResponsesForCli</code> is populated with the responses from trying to initialise the <em>Testers</em> (only successful)</p>
</li>
<li>
<p>A response is returned to the CLI with <code>initTesterResponsesForCli</code> and whether the <em>orchestrator</em> expects the CLI to use <code>sse</code> or <code>lp</code></p>
</li>
</ol>
</li>
</ol>
</li>
</ul>
</li>
<li><strong>CLI makes a <code>GET</code> request</strong> to either of the following (currently this happens whether all <em>Testers</em> were initialised successfully or not, there is no point in this happening if there were any <code>Tester failure:</code> messages returned from any <em>Testers</em>, we will change this soon):
<ul>
<li>If using <code>sse</code>?   <code>/tester-feedback/{testerName}/{sessionId}</code>:<br>
In this case messages from the <em>Test Sessions</em> continue to flow through the Redis channels and the <em>orchestrator</em> continues to push them to the CLI</li>
<li>If using <code>lp</code>?   <code>/poll-tester-feedback/{testerName}/{sessionId}</code>:<br>
In this case the CLI starts the long-poll process, the <em>orchestrator</em> checks to see if <code>warmUpTestSessionMessageSets</code> contains an element for the given channel name (BTW: channel names are constructed like: <code>${testerName}-${sessionId</code>) (this will only happen in the <code>cloud</code> environment), if so it is <code>splice</code>d out and returned, if not the <code>pollTesterMessages</code> of the <code>testerWatcher</code> is invoked. <code>pollTesterMessages</code> is responsible for providing a callback to each Redis channel which when invoked takes the given message from a <em>Testers</em> <em>Test Session</em> and pushes it on to the tail of a Redis list with the same name as the Redis channel that the message was received from. Each time the CLI requests a message set for a given <em>Test Session</em>, if no messages are yet available it waits (on Redis <code>blpop</code> (blocking head pop)), if messages are available, they are popped (Redis <code>lpop</code> (non blocking head pop)) from the head of the Redis list</li>
</ul>
</li>
<li><strong>CLI makes a <code>GET</code> request</strong> to the <code>/outcomes</code> route
<ul>
<li>This happens once the CLI receives a message starting with <code>All Test Sessions of all Testers are finished</code>. By the time this has happens, the <em>orchestrator</em> has already cleaned up the <em>Testers</em> and created the <em>Outcomes</em> archive based on the results and reports generated by the <em>Testers</em></li>
</ul>
</li>
</ol>
<h1 id="tls-tester-implementation">TLS Tester Implementation</h1>
<p>Unlike the App <em>Tester</em> (<a href="https://github.com/purpleteam-labs/purpleteam-app-scanner" target="_blank" rel="noopener">app-scanner</a>) which supervises an external <em>Emissary</em> (Zaproxy), the TLS <em>Tester</em> (<a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner" target="_blank" rel="noopener">tls-scanner</a>) supervises an embedded <em>Emissary</em> (testssl.sh). This means that the TLS <em>Emissary</em> runs within the same container as the TLS <em>Tester</em>.</p>
<p>The <a href="https://purpleteam-labs.com/doc/job-file/" target="_blank" rel="noopener"><em>Job</em></a> file which the <a href="https://purpleteam-labs.com/doc/definitions/" target="_blank" rel="noopener"><em>Build User</em></a> provides to the <a href="https://github.com/purpleteam-labs/purpleteam" target="_blank" rel="noopener">CLI</a> contains everything required to get the TLS <em>Emissary</em> running and targeting your website or web API.</p>
<p>The implementation of the TLS <em>Tester</em> was actually the easy part of this release. An additional stage one container image was required for <code>local</code> and also in the Terraform configuration for <code>cloud</code> in the form of AWS ECS Task Definition modification. The AWS ECR deployment script needed adding to.</p>
<p>The new TLS <em>Tester</em> isn&rsquo;t that different from the App <em>Tester</em> other than it is a lot simpler because we don&rsquo;t have to bring up stage two containers, and all the potential synchronisation issues around external <em>Emissaries</em>.</p>
<p>The execution flow goes from the <code>/init-tester</code> and <code>/start-tester</code> <a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner/blob/main/src/api/tls/routes/post.js" target="_blank" rel="noopener">routes</a> to the <a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner/blob/main/src/api/tls/models/tls.js" target="_blank" rel="noopener">model</a>.</p>
<p><code>/init-tester</code> basically sets the <em>Tester</em> up with the <em>Build User</em> supplied <em>Job</em> and sets the <code>status</code>.</p>
<p><code>/start-tester</code> <a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner/blob/7b2d453c63f6a280132b45d2db9a546bf6fc0d19/src/api/tls/models/tls.js#L74" target="_blank" rel="noopener">starts (<code>spawn</code>s)</a> the <a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner/blob/main/src/scripts/runCuc.js#L71" target="_blank" rel="noopener">Cucumber CLI</a>,
which initialises the <a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner/blob/main/src/steps/world.js" target="_blank" rel="noopener">Cucumber world</a> which is where most of the domain specific parts are glued together, and the actual Cucumber Steps (tests) are run.</p>
<p>The following are added to the Cucumber <code>world</code>:</p>
<ul>
<li>The <code>messagePublisher</code> (pushes messages onto Redis <code>${testerName}-${sessionId</code> channels)</li>
<li><code>sut</code> (System Under Test) domain object</li>
<li><code>testssl</code> domain object</li>
</ul>
<p>The <a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner/blob/7b2d453c63f6a280132b45d2db9a546bf6fc0d19/src/steps/tls_scan_steps.js#L78" target="_blank" rel="noopener">testssl.sh process is <code>spawn</code>ed</a>.</p>
<p>When ever the TLS <em>Emissary</em> writes to <code>stdout</code> the <em>Tester</em> deals with it <a href="https://github.com/purpleteam-labs/purpleteam-tls-scanner/blob/7b2d453c63f6a280132b45d2db9a546bf6fc0d19/src/steps/tls_scan_steps.js#L80" target="_blank" rel="noopener">here</a>.</p>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/tls/">tls</a>
  
  <a class="badge badge-light" href="/tags/ssl/">ssl</a>
  
  <a class="badge badge-light" href="/tags/application-security/">application-security</a>
  
  <a class="badge badge-light" href="/tags/bdd/">bdd</a>
  
  <a class="badge badge-light" href="/tags/blue-team/">blue-team</a>
  
  <a class="badge badge-light" href="/tags/build-pipeline/">build-pipeline</a>
  
  <a class="badge badge-light" href="/tags/build-tool/">build-tool</a>
  
  <a class="badge badge-light" href="/tags/cd/">cd</a>
  
  <a class="badge badge-light" href="/tags/ci/">ci</a>
  
  <a class="badge badge-light" href="/tags/cli/">cli</a>
  
  <a class="badge badge-light" href="/tags/cloud/">cloud</a>
  
  <a class="badge badge-light" href="/tags/cloud-security/">cloud-security</a>
  
  <a class="badge badge-light" href="/tags/continuous-deployment/">continuous-deployment</a>
  
  <a class="badge badge-light" href="/tags/continuous-integration/">continuous-integration</a>
  
  <a class="badge badge-light" href="/tags/cybersecurity/">cybersecurity</a>
  
  <a class="badge badge-light" href="/tags/dev-sec-ops/">dev-sec-ops</a>
  
  <a class="badge badge-light" href="/tags/dev-ops/">dev-ops</a>
  
  <a class="badge badge-light" href="/tags/docker/">docker</a>
  
  <a class="badge badge-light" href="/tags/free-and-open-source/">free-and-open-source</a>
  
  <a class="badge badge-light" href="/tags/information-security/">information-security</a>
  
  <a class="badge badge-light" href="/tags/infosec/">infosec</a>
  
  <a class="badge badge-light" href="/tags/owasp/">owasp</a>
  
  <a class="badge badge-light" href="/tags/owasp-zap/">owasp-zap</a>
  
  <a class="badge badge-light" href="/tags/penetration-testing/">penetration-testing</a>
  
  <a class="badge badge-light" href="/tags/purpleteam/">purpleteam</a>
  
  <a class="badge badge-light" href="/tags/red-team/">red-team</a>
  
  <a class="badge badge-light" href="/tags/security/">security</a>
  
  <a class="badge badge-light" href="/tags/security-regression-testing/">security-regression-testing</a>
  
  <a class="badge badge-light" href="/tags/software/">software</a>
  
  <a class="badge badge-light" href="/tags/software-security/">software-security</a>
  
  <a class="badge badge-light" href="/tags/security-testing/">security-testing</a>
  
  <a class="badge badge-light" href="/tags/terminal/">terminal</a>
  
  <a class="badge badge-light" href="/tags/testing/">testing</a>
  
  <a class="badge badge-light" href="/tags/tool/">tool</a>
  
  <a class="badge badge-light" href="/tags/web/">web</a>
  
  <a class="badge badge-light" href="/tags/web-application/">web-application</a>
  
  <a class="badge badge-light" href="/tags/web-application-security/">web-application-security</a>
  
  <a class="badge badge-light" href="/tags/web-security/">web-security</a>
  
  <a class="badge badge-light" href="/tags/zap/">zap</a>
  
  <a class="badge badge-light" href="/tags/testssl.sh/">testssl.sh</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/&amp;text=PurpleTeam%20TLS%20Tester%20Implementation" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/&amp;t=PurpleTeam%20TLS%20Tester%20Implementation" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=PurpleTeam%20TLS%20Tester%20Implementation&amp;body=https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/&amp;title=PurpleTeam%20TLS%20Tester%20Implementation" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=PurpleTeam%20TLS%20Tester%20Implementation%20https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/&amp;title=PurpleTeam%20TLS%20Tester%20Implementation" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="/author/kim-carter/"><img class="avatar mr-3 avatar-circle" src="/author/kim-carter/avatar_hubad7f6bec0af2a985095578f059615ed_29848_270x270_fill_q90_lanczos_center.jpg" alt="Kim Carter"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="/author/kim-carter/">Kim Carter</a></h5>
      <h6 class="card-subtitle">Technologist / Engineer, Information Security Professional</h6>
      <p class="card-text">Technologist / Engineer, Information Security Professional, Entrepreneur and the founder of BinaryMist Ltd and PurpleTeam-Labs. Ex OWASP NZ Chapter Leader of eight years. Certified Scrum Master. Facilitator, mentor and motivator of cross functional, self managing teams. With a solid 20 years of commercial industry experience across many domains.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/binarymist" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/binarymist" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://nz.linkedin.com/in/carterkim" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://leanpub.com/u/kimcarter" target="_blank" rel="noopener">
        <i class="fab fa-leanpub"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.amazon.com/Kim-Carter/e/B01M0HLO9I" target="_blank" rel="noopener">
        <i class="fab fa-amazon"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="http://www.se-radio.net/team/kim-carter" target="_blank" rel="noopener">
        <i class="fas fa-podcast"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.youtube.com/channel/UCNJkTyC_2_eXwljKsrXLgzg" target="_blank" rel="noopener">
        <i class="fab fa-youtube"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/binarymist/InfoSecNZ" target="_blank" rel="noopener">
        <i class="fab fa-slack"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  








  <section id="comments">
    
    
      <section class="staticman-comments post-comments">
        <h3>Comments</h3>

        
        
        
        
          
        
          
        
          
        
          
        
        
        
          <p>Be the first to leave a comment.</p>
        

      </section>      
      

        <section class="staticman-comments post-comments">

          <h3>Say something</h3>
          Your email is used for <a href="https://gravatar.com" target="_blank">Gravatar</a> image and reply notifications only.<br>
          Subscribe to new blog posts <a href="/blog" >here</a>.
          
          <form class="post-new-comment staticman" method="post" action="#comments">
            <div class="form-action-value" hidden>https://bmstaticmaninstance.herokuapp.com/v3/entry/github/binarymist/BinaryMistBlog/master/comments</div>
            <input type="hidden" name="options[redirect]" value="https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/#comment-submitted">
            <input type="hidden" name="options[slug]" value="purpleteam-tls-tester">
            <input type="hidden" name="fields[postName]" value="purpleteam-tls-tester"/>          
            <input type="text" name="fields[name]" class="post-comment-field" placeholder="Name *" required/>
            <input type="email" name="fields[email]" class="post-comment-field" placeholder="Email address (will not be public) *" required/>
            <textarea name="fields[comment]" class="post-comment-field" placeholder="Comment (markdown is accepted) *" required rows="10"></textarea>
            <label class="post-comment-field label">Help fight spam. Enter the correct answer in the next field *</label>
            <label class="post-comment-field js-note label">JavaScript must be enabled to see question.</label>
            <input type="text" name="validateRealUser" class="post-comment-field" required/>
            
            <input type="hidden" name="options[origin]" value="https://binarymist.io/blog/2021/09/07/purpleteam-tls-tester-implementation/#comments">
            <input type="hidden" name="options[parent]" value="purpleteam-tls-tester">
            <input id="form-submit" type="checkbox" name="options[subscribe]" class="checkbox post-comment-field" value="email">
            <label for="form-submit" class="post-comment-field checkbox-label"> &nbsp Notify me of new comments on this post</label>
            
            <input type="submit" class="post-comment-field btn btn-primary comment-buttons" value="Submit">
          </form>
        </section>

        <div id="comment-submitted" class="dialog">
          <h3>Thank you</h3>
          <p>Your comment has been submitted and will be published once it has been approved.</p>
          <p><a href="https://github.com/binarymist/BinaryMistBlog/pulls">Click here</a> to see the pull request you generated.</p>
          
          <p><a href="#" class="btn btn-primary comment-buttons ok">OK</a></p>
        </div>

      

    
  </section>








  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/event/2021-purple-teaming-with-purpleteam-owasp-20th-anniversary/">Talk - Purple Teaming with OWASP purpleteam</a></li>
      
      <li><a href="/event/2021-10-29-purple-teaming-with-purpleteam-all-day-dev-ops/">Talk - Purple Teaming with OWASP purpleteam</a></li>
      
      <li><a href="/blog/2021/02/17/purpleteam-at-alpha/">PurpleTeam at Alpha</a></li>
      
      <li><a href="/event/appsecnz-2021-talk-building-purpleteam-a-security-regression-testing-saas-from-poc-to-alpha/">Talk - Building PurpleTeam (a Security Regression Testing SaaS) - From PoC to Alpha</a></li>
      
      <li><a href="/publication/holistic-infosec-for-web-developers/">Holistic Info-Sec for Web Developers</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/publication/privacy/">Privacy Policy</a>
    
    
  </p>
  

  <p class="powered-by">
    © 2018 BinaryMist Ltd

    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
      
    
    <script src="/en/js/wowchemy.min.6200eefc9be7f27d689647c34ff0478c.js"></script>

    






</body>
</html>
